# @package _global_
defaults:
  - _self_

checkpoint: /home/xiziheng/develop/emg2pose/logs/emg2vqvae/2025-12-25/11-39-06/lightning_logs/version_0/checkpoints/best-monitor_metric=0.0000.ckpt

emg2vqvae:
  model:
    _target_: emg2pose.models.modules.emg_to_vqvae_latent.EmgToVQVAELatent
    in_channels: 16
    conv_channels: [64, 128, 128, 128]
    conv_kernels: [10, 6, 4, 3]
    conv_strides: [3, 2, 1, 1]
    conv_paddings: [5, 2, 1, 0]
    dropout: 0.2
    gru_hidden: 512
    gru_layers: 2
    num_codes: 128
    num_groups: 5
    align_kernel: 31
    output_steps: 400
  vqvae:
    _target_: emg2pose.models.modules.vqvae_vqmyo.JointAngleVQVAE
    embed_dim: 10
    num_codes: 128
    commitment_cost: 0.25
    dropout: 0.0
  vqvae_checkpoint: /home/xiziheng/develop/emg2pose/logs/vqvae/2025-12-22/10-19-40/lightning_logs/version_0/checkpoints/best-monitor_metric=0.0000.ckpt
  gumbel:
    temperature: 1.0
    hard: false
  loss_weights:
    latent: 1.0
    recon: 0.5
  label_smoothing: 0.05
matmul_precision: high
datamodule:
  window_length: 4_000
  val_test_window_length: 4_000
  stride: 4_000
  val_test_stride: 4_000
  norm_mode: batch
  max_open_files: 4
  skip_ik_failures: True

batch_size: 160
optimizer:
  lr: .0001
trainer:
  max_epochs: 50
  devices: [0]
  check_val_every_n_epoch: 1

transforms:
  train:
    - _target_: emg2pose.transforms.ExtractField
      field: "emg"
    - _target_: emg2pose.transforms.RotationAugmentation
      channel_dim: -1
    - _target_: emg2pose.transforms.ToFloatTensor
  val:
    - ${to_tensor}
  test: ${transforms.val}
